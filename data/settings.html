<!DOCTYPE html>
<html>
  <head>
    <title>Settings</title>
    <link rel="icon" href="./favicon.ico">
    <link type="text/css" rel="stylesheet" href="./style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <meta http-equiv="content-type" charset="utf-8">    

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>

    <script type="text/javascript">

          function doPost(url, data) {
            console.log(url);
            var xhr = new XMLHttpRequest();
            xhr.open("POST", url);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onload = () => {
              console.log(xhr.status);
              console.log("success!");
            };
            xhr.onerror = () => {
              console.log(xhr.status);
              console.log("error!");
            };
            xhr.send(data);
          }

          $(function(){

            $("#SUBMIT_SETTING").click( function(){
                var url = "http://esp8266.local/settings";
    
                var JSONdata = {
                    SPERK_TIME: parseInt($("#SPERK_TIME").val()),
                    RELEASE_TIME: parseInt($("#RELEASE_TIME").val())      
                };

                doPost(url, JSON.stringify(JSONdata));

              })
          })
    </script>
    </head>
    <body id="body"> 
    <h1>Settings</h1>
    <hr>
    <p>
      <form>
      <table>
        <tr>
          <td>放電時間(ms)：</td><td><input type="text" id="SPERK_TIME" name="SPERK_TIME" value="0" /></td>
        </tr>
        <tr>
          <td>リリース時間(ms)：</td><td><input type="text" id="RELEASE_TIME" name="RELEASE_TIME" value="0" /></td>
        </tr>
      </table>
      <button type="submit" name="submit" id="SUBMIT_SETTING" class="button button3">設定</button>
      <button type="reset" name="reset" id="RESET_SETTING" class="button button3">リセット</button>
    </form>
    </p>    
</body>
</html>